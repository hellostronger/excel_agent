# Excel智能分析系统 - 前端测试界面

这是一个基于Flask的Web前端，用于测试Excel智能分析系统的功能。系统支持上传Excel文件并通过AI进行智能数据分析和问答。

## 功能特性

### 🚀 核心功能
- **Excel文件上传**: 支持拖拽上传和点击上传 (.xlsx, .xls, .xlsm)
- **智能数据分析**: AI驱动的数据统计、异常检测、相关性分析
- **自然语言问答**: 用中文提问，获得数据分析结果
- **代码生成**: 自动生成对应的Python分析代码
- **数据可视化**: 生成图表和可视化建议

### 🎯 分析能力
- 📊 基本统计信息分析
- 🔍 异常值和离群点检测
- 🔗 数据相关性分析
- 📈 趋势分析和模式识别
- 🎨 数据可视化图表生成
- 📋 数据清洗建议

## 快速开始

### 1. 安装依赖

```bash
# 安装基础依赖
pip install -r frontend_requirements.txt
```

### 2. 启动系统

```bash
# 方法1: 使用启动脚本（推荐）
python run_frontend.py

# 方法2: 直接运行Flask应用
cd backend
python app.py
```

### 3. 访问界面

打开浏览器访问: **http://localhost:5000**

## 系统架构

### 前端界面 (`frontend/index.html`)
- 现代化的响应式Web界面
- 支持拖拽上传和文件预览
- 实时处理状态显示
- 多标签页结果展示

### 后端API (`backend/app.py`)
- Flask RESTful API服务
- 文件上传和处理
- 智能分析引擎集成
- 支持演示模式（无Agent系统时）

### MCP集成
- 如果检测到完整的Agent系统，将使用真实的AI分析
- 如果Agent系统不可用，将运行在演示模式，提供模拟分析结果

## API接口

### 系统状态
```
GET /api/status
```

### 文件上传
```
POST /api/upload
Content-Type: multipart/form-data
```

### 文件处理
```
POST /api/process/{file_id}
```

### 数据查询
```
POST /api/query
Content-Type: application/json
{
  "file_id": "xxx",
  "query": "用户问题"
}
```

## 使用说明

### 1. 上传Excel文件

- 点击"选择文件"或直接拖拽Excel文件到上传区域
- 支持的格式: `.xlsx`, `.xls`, `.xlsm`
- 最大文件大小: 50MB
- 系统会自动显示文件信息和处理进度

### 2. 等待文件处理

系统会自动执行以下处理步骤：
1. **📤 文件上传** - 上传到服务器
2. **📊 文件解析** - 解析Excel结构和数据
3. **🔍 数据分析** - 进行初步数据分析
4. **✅ 准备就绪** - 准备接受用户查询

### 3. 提出问题

在右侧查询区域输入您的问题，例如：
- "请帮我分析这个表格的基本统计信息"
- "找出数据中的异常值和离群点" 
- "各个数值列之间有什么关联关系？"
- "生成一个数据可视化图表"

### 4. 查看结果

系统会在三个标签页中显示结果：
- **📋 分析结果**: AI生成的详细分析报告
- **📊 数据预览**: Excel文件的数据预览
- **💻 生成代码**: 对应的Python分析代码

## 示例问题

### 📈 统计分析类
- "这个表格有多少行多少列？"
- "请分析各个数值列的基本统计信息"
- "哪个产品的销售额最高？"
- "平均利润率是多少？"

### 🔍 异常检测类
- "找出数据中的异常值"
- "检测离群点"
- "哪些数据可能有质量问题？"
- "是否有重复记录？"

### 🔗 关联分析类
- "各个变量之间有什么关联？"
- "销售额和利润的相关性如何？"
- "哪些因素影响销售业绩？"

### 📊 可视化类
- "生成销售趋势图"
- "制作产品类别分布饼图"
- "创建相关性热力图"

## 系统模式

### 🤖 完整模式 (Full Agent Mode)
当检测到完整的Agent系统时：
- 使用真实的AI分析引擎
- 集成MCP协议增强功能
- 提供准确的数据分析结果
- 生成实际可执行的Python代码

### 🎭 演示模式 (Demo Mode)
当Agent系统不可用时：
- 自动切换到演示模式
- 提供模拟的分析结果
- 仍可体验完整的用户界面
- 适用于功能演示和界面测试

## 技术栈

### 前端技术
- **HTML5/CSS3**: 现代化响应式界面
- **JavaScript ES6+**: 异步文件处理和API调用
- **拖拽API**: 支持文件拖拽上传
- **Fetch API**: RESTful API通信

### 后端技术  
- **Flask**: 轻量级Web框架
- **Pandas**: 数据分析和处理
- **Matplotlib/Seaborn**: 数据可视化
- **OpenPyXL**: Excel文件读写
- **NumPy/SciPy**: 科学计算

### AI增强
- **MCP协议**: Model Context Protocol集成
- **Agent系统**: 智能代理协调
- **RAG架构**: 检索增强生成
- **异步处理**: 高性能数据处理

## 故障排除

### 常见问题

1. **文件上传失败**
   - 检查文件格式是否为Excel格式
   - 确认文件大小不超过50MB
   - 检查网络连接

2. **处理超时**
   - 大文件可能需要更长处理时间
   - 检查服务器资源情况
   - 尝试刷新页面重新上传

3. **分析结果异常**
   - 确认Excel文件格式正确
   - 检查数据是否包含必要的列
   - 尝试不同的问题表达方式

4. **系统运行在演示模式**
   - 这表明完整的Agent系统未安装
   - 演示模式仍可体验所有界面功能
   - 如需真实分析，请安装完整系统依赖

### 日志查看

系统运行时会在控制台输出详细日志：
- 文件上传状态
- 处理进度信息
- API请求响应
- 错误信息和调试信息

### 性能优化建议

1. **文件大小**: 建议单个文件不超过10MB以获得最佳性能
2. **数据格式**: 确保Excel数据格式规范，避免复杂的合并单元格
3. **问题表达**: 使用清晰具体的问题描述以获得更好的分析结果
4. **浏览器兼容**: 建议使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 扩展功能

系统设计为高度可扩展，您可以：

1. **添加新的分析功能**: 在后端添加新的分析算法
2. **自定义界面主题**: 修改CSS样式
3. **集成外部API**: 连接其他数据源或AI服务
4. **增加文件格式支持**: 扩展支持CSV、TSV等格式
5. **多语言支持**: 添加英文或其他语言界面

## 开发和部署

### 开发环境
```bash
# 克隆项目
git clone <repository-url>
cd excel_agent

# 安装依赖
pip install -r frontend_requirements.txt

# 启动开发服务器
python run_frontend.py
```

### 生产部署
```bash
# 使用Gunicorn部署
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 backend.app:app

# 或使用uWSGI部署
pip install uwsgi
uwsgi --http :5000 --wsgi-file backend/app.py --callable app
```

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进系统功能！

---

🎉 **开始体验Excel智能分析系统吧！** 上传您的Excel文件，让AI帮您发现数据中的洞察！